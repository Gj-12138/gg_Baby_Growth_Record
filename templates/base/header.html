{% load template_tags_filters %}
{% get_categorys as categorys %}
{% get_tags as tags %}

<nav class="navbar navbar-baby">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#baby-navbar-collapse" aria-expanded="false">
                    <span class="sr-only">切换导航</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">
                    <i class="fa fa-child"></i> 宝宝的成长记录
                </a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="baby-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="{% url 'main:index' %}"><i class="fa fa-home baby-icon"></i>首页</a></li>

{#                    <li class="dropdown">#}
{#                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">#}
{#                            <i class="fa fa-tags baby-icon"></i>标签 <span class="caret"></span>#}
{#                        </a>#}
{#                        <ul class="dropdown-menu">#}
{#                            {% for tag in tags %}#}
{#                            <li><a href="{% url 'main:article_list' %}?tag={{ tag.id }}"><i class="fa fa-tag"></i> {{ tag.tag }}</a></li>#}
{#                            {% endfor %}#}
{#                        </ul>#}
{#                    </li>#}

                    <li><a href="{% url 'main:article_list' %}"><i class="fa fa-comments baby-icon"></i>宝宝社区</a></li>

                {% if request.user.is_authenticated %}
                     <li><a href="{% url 'main:record_list' %}"><i class="fa fa-line-chart baby-icon"></i>成长记录</a></li>
                    <li><a href="{% url 'main:vaccine_record_list' %}"><i class="fa fa-heartbeat baby-icon"></i>接种记录</a></li>
                    <li><a href="{% url 'main:event_list' %}"><i class="fa fa-star baby-icon"></i>里程碑</a></li>
                {% endif %}
                <li><a href="{% url 'main:vaccine_list' %}"><i class="fa fa-medkit baby-icon"></i>疫苗字典</a></li>
                </ul>

{#                <form class="navbar-form navbar-left" method="get" action="{% url 'main:article_list' %}">#}
{#                    <div class="form-group">#}
{#                        <input#}
{#                                type="text"#}
{#                                class="form-control"#}
{#                                placeholder="搜索文章..."#}
{#                                name="query"#}
{#                                value="{{ request.GET.query|default:'' }}"#}
{#                                onkeydown="if(event.keyCode===13)this.form.submit();"#}
{#                        >#}
{#                    </div>#}
{#                    <button type="submit" class="btn btn-default"><i class="fa fa-search"></i> 搜索</button>#}
{#                    {% if request.GET.query %}#}
{#                        <a#}
{#                            href="{% url 'main:article_list' %}{% if request.GET.category %}?category={{ request.GET.category }}{% endif %}"#}
{#                            class="btn btn-default btn-sm"#}
{#                        >#}
{#                            <i class="fa fa-times"></i> 清除#}
{#                        </a>#}
{#                    {% endif %}#}
{#                </form>#}
                <form class="navbar-form navbar-left" method="get" action="/search/" target="_blank">
                    <div class="form-group">
                        <input
                                type="text"
                                class="form-control"
                                placeholder="搜索文章..."
                                name="q"
                        >
                    </div>
                    <button type="submit" class="btn btn-default"><i class="fa fa-search"></i> 搜索</button>
                    {% if request.GET.query %}
                        <a
                            href="{% url 'main:article_list' %}{% if request.GET.category %}?category={{ request.GET.category }}{% endif %}"
                            class="btn btn-default btn-sm"
                        >
                            <i class="fa fa-times"></i> 清除
                        </a>
                    {% endif %}
                </form>

                <ul class="nav navbar-nav navbar-right">
                    {% if request.user.is_authenticated %}
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                            <img src="/media/{{ request.user.avatar }}" alt="头像" class="user-avatar">
                            <span class="user-info">{{ request.user.username }}</span>
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            {% if request.user.is_staff %}
                                <li><a href="{% url 'users:admin' %}"><i class="fa fa-cog"></i> 管理中心</a></li>
                            {% endif %}
                            <li><a href="{% url 'users:usercenter' %}"><i class="fa fa-user"></i> 个人中心</a></li>
                            <li><a href="{% url 'main:article_manage' %}"><i class="fa fa-edit"></i> 创作中心</a></li>
                            <li><a href="{% url 'users:passwordchange' %}"><i class="fa fa-key"></i> 修改密码</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="{% url 'users:logout' %}"><i class="fa fa-sign-out"></i> 退出登录</a></li>
                        </ul>
                    </li>

                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-share-alt baby-icon"></i> 分享 <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="{% url 'main:article_form' %}"><i class="fa fa-plus"></i> 创建文章</a></li>
                            <li><a href="{% url 'main:article_manage' %}"><i class="fa fa-list"></i> 管理文章</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="#"><i class="fa fa-share"></i> 分享成长</a></li>
                        </ul>
                    </li>

                    {% if request.user.is_parent %}
                        <li><a href="{% url 'users:baby' %}"><i class="fa fa-child baby-icon"></i> 宝宝</a></li>
                    {% endif %}

                    {% else %}
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-user baby-icon"></i> 未登录 <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="{% url 'users:login' %}"><i class="fa fa-sign-in"></i> 登录</a></li>
                            <li><a href="{% url 'users:register' %}"><i class="fa fa-user-plus"></i> 注册</a></li>
                        </ul>
                    </li>
                    {% endif %}
                </ul>
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>